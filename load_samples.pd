#N canvas 0 0 1680 1022 12;
#X obj 608 181 list_samples;
#X obj 808 181 text define note_to_wav;
#X obj 837 282 text delete note_to_wav;
#X msg 808 251 -1;
#X obj 572 49 inlet;
#N canvas 92 130 556 433 arrays 0;
#X obj 10 0 table array-107-4;
#X obj 10 20 table array-107-1;
#X obj 10 40 table array-107-3;
#X obj 10 60 table array-101-4;
#X obj 10 80 table array-101-1;
#X obj 10 100 table array-101-3;
#X obj 10 120 table array-95-4;
#X obj 10 140 table array-95-1;
#X obj 10 160 table array-95-3;
#X obj 10 180 table array-89-4;
#X obj 10 200 table array-89-1;
#X obj 10 220 table array-89-3;
#X obj 10 240 table array-83-4;
#X obj 10 260 table array-83-1;
#X obj 10 280 table array-83-3;
#X obj 10 300 table array-77-4;
#X obj 10 320 table array-77-1;
#X obj 10 340 table array-77-3;
#X obj 10 360 table array-71-4;
#X obj 10 380 table array-71-1;
#X obj 10 400 table array-71-3;
#X obj 10 420 table array-65-4;
#X obj 10 440 table array-65-1;
#X obj 10 460 table array-65-3;
#X obj 10 480 table array-59-4;
#X obj 10 500 table array-59-1;
#X obj 10 520 table array-59-3;
#X obj 10 540 table array-53-4;
#X obj 10 560 table array-53-1;
#X obj 10 580 table array-53-3;
#X obj 10 600 table array-47-4;
#X obj 10 620 table array-47-1;
#X obj 10 640 table array-47-3;
#X obj 10 660 table array-41-4;
#X obj 10 680 table array-41-1;
#X obj 10 700 table array-41-3;
#X obj 10 720 table array-35-4;
#X obj 10 740 table array-35-1;
#X obj 10 760 table array-35-3;
#X obj 10 780 table array-29-4;
#X obj 10 800 table array-29-1;
#X obj 10 820 table array-29-3;
#X obj 10 840 table array-23-4;
#X obj 10 860 table array-23-1;
#X obj 10 880 table array-23-3;
#X restore 733 790 pd arrays;
#X obj 589 445 until;
#X msg 589 515 step;
#X msg 761 410 line 0;
#X obj 787 511 float;
#X floatatom 818 371 5 0 0 0 - - - 0;
#X obj 589 480 t b b;
#X obj 856 511 + 1;
#X obj 787 546 t f f;
#X obj 621 790 s pd-arrays;
#X obj 787 581 * 20;
#X msg 462 511 clear;
#X obj 589 347 t b b b b;
#X text 316 510 reset subpatch -->;
#X text 870 370 <-- init counter value;
#X text 896 510 <-- increment counter each sample;
#X text 322 409 iterate for each sample in file -->;
#X text 829 584 <-- y-offset of new object in subpatch;
#X text 835 754 <-- dynamically add table to subpatch;
#X obj 589 585 t l l;
#X obj 591 868 soundfiler;
#X floatatom 591 903 5 0 0 0 - - - 0;
#X text 395 216 populate note_to_wav list -->;
#X text 638 906 <-- number of samples in this wav file;
#X text 835 786 <-- click to view subpatch;
#X text 993 180 <-- ensure text lists exist;
#X text 1028 281 <-- ensure text lists begin empty;
#X text 429 623 midi_note \, path_to_wav -->;
#X text 450 722 midi_note \, y-offset -->;
#X text 316 542 read lines: midi_note \, path_to_wav -->;
#X obj 621 720 pack s f;
#X msg 621 755 obj 10 \$2 table \$1;
#X text 493 685 name of array -->;
#X msg 155 901 88;
#X obj 155 936 until;
#X obj 155 971 float;
#X msg 224 936 21;
#X text 203 900 <-- iterate once for each piano key;
#X text 267 1011 <-- iterate all 88 midi notes \, 21-108;
#X text 271 935 <-- initialize counter to 21 \, the first note (A0);
#X obj 155 866 t b b;
#X obj 808 216 text define _note_to_array;
#X obj 808 309 text delete _note_to_array;
#X obj 589 550 text sequence note_to_wav;
#X obj 589 410 text size note_to_wav;
#X obj 608 216 text fromlist note_to_wav;
#X text 38 33 This subpatch receives an instrument name and returns a list of: (midi_note \, array_name \, note_offset \, num_samples), f 65;
#X msg 638 49 symbol rhodes;
#X obj 229 1011 + 1;
#X obj 178 1048 t b b b f, f 13;
#X obj 207 1144 float, f 9;
#X msg 178 1078 1, f 2;
#X msg 207 1078 3, f 2;
#X msg 236 1078 4, f 2;
#X obj 207 1110 t b f;
#X obj 207 1176 pack f f;
#X obj 209 1542 text insert _note_to_array;
#X text 401 1542 <-- note_to_array is a list of: midi_note \, strength (1 \, 3 \, 4) \, array_name \, note_offset \, num_samples, f 101;
#X obj 209 1503 pack f f s f f, f 17;
#X text 275 1174 <-- tuple of midi_note \, strength (1 \, 3 \, 4);
#X text 276 1077 <-- permute midi note with strength (1 \, 3 \, 4);
#X obj 155 1010 t f f f;
#X obj 207 1209 text search note_to_wav near 0 near 1;
#X obj 207 1244 text get note_to_wav;
#X obj 239 1306 unpack f f s;
#X text 477 1208 <-- get the closest sample for this midi note and velocity;
#X text 343 1307 <-- extract the matching midi note and strength (wav path is ignored), f 72;
#X obj 47 1395 float;
#X msg 278 1400 symbol array-\$1-\$2;
#X obj 278 1372 pack f f;
#X obj 207 1274 t b l;
#X obj 125 1415 -, f 8;
#X obj 125 1384 float;
#X obj 125 1352 t b f, f 8;
#X obj 326 1465 array size;
#X obj 58 1613 select 108;
#X text 145 1612 <-- selecting 108 runs at end of loop;
#X obj 58 1693 outlet;
#X obj 58 1653 text tolist _note_to_array;
#X text 124 1692 <-- return the _note_to_list map as a list;
#X obj 326 1432 t b s;
#X obj 621 624 unpack f f s;
#X msg 621 685 array-\$1-\$2;
#X obj 621 654 pack f f;
#X msg 591 833 read -resize \$3 array-\$1-\$2;
#X obj 642 1132 float;
#X text 1133 24 Copyright (c) 2025 Jonathan Schoonhoven All rights reserved. Redistribution and use of this file \, in source or binary form \, without explicit permission from the copyright holder is prohibited., f 73;
#X obj 572 84 t b b s b b b;
#X obj 807 141 switch~;
#X msg 806 114 0;
#X connect 0 0 50 0;
#X connect 3 0 2 0;
#X connect 3 0 47 0;
#X connect 4 0 92 0;
#X connect 6 0 11 0;
#X connect 7 0 48 0;
#X connect 8 0 48 0;
#X connect 9 0 13 0;
#X connect 10 0 9 1;
#X connect 11 0 7 0;
#X connect 11 1 9 0;
#X connect 12 0 9 1;
#X connect 13 0 15 0;
#X connect 13 1 12 0;
#X connect 15 0 35 1;
#X connect 16 0 14 0;
#X connect 17 0 49 0;
#X connect 17 1 8 0;
#X connect 17 2 10 0;
#X connect 17 3 16 0;
#X connect 24 0 89 0;
#X connect 24 1 86 0;
#X connect 25 0 26 0;
#X connect 35 0 36 0;
#X connect 36 0 14 0;
#X connect 38 0 39 0;
#X connect 39 0 40 0;
#X connect 40 0 66 0;
#X connect 41 0 40 1;
#X connect 45 0 38 0;
#X connect 45 1 41 0;
#X connect 48 0 24 0;
#X connect 49 0 6 0;
#X connect 52 0 92 0;
#X connect 53 0 40 1;
#X connect 54 0 56 0;
#X connect 54 1 57 0;
#X connect 54 2 58 0;
#X connect 54 3 55 1;
#X connect 55 0 60 0;
#X connect 55 0 77 1;
#X connect 55 0 72 1;
#X connect 56 0 59 0;
#X connect 57 0 59 0;
#X connect 58 0 59 0;
#X connect 59 0 55 0;
#X connect 59 1 60 1;
#X connect 59 1 90 0;
#X connect 60 0 67 0;
#X connect 63 0 61 0;
#X connect 66 0 80 0;
#X connect 66 1 54 0;
#X connect 66 2 53 0;
#X connect 67 0 68 0;
#X connect 68 0 75 0;
#X connect 69 0 74 0;
#X connect 69 0 78 0;
#X connect 69 1 74 1;
#X connect 72 0 63 0;
#X connect 73 0 63 2;
#X connect 73 0 85 0;
#X connect 74 0 73 0;
#X connect 75 0 72 0;
#X connect 75 1 69 0;
#X connect 76 0 63 3;
#X connect 77 0 76 0;
#X connect 78 0 77 0;
#X connect 78 1 76 1;
#X connect 79 0 63 4;
#X connect 80 0 83 0;
#X connect 83 0 82 0;
#X connect 85 0 79 0;
#X connect 85 1 79 1;
#X connect 86 0 88 0;
#X connect 86 1 88 1;
#X connect 87 0 35 0;
#X connect 88 0 87 0;
#X connect 89 0 25 0;
#X connect 90 0 63 1;
#X connect 92 0 45 0;
#X connect 92 1 17 0;
#X connect 92 2 0 0;
#X connect 92 3 3 0;
#X connect 92 4 1 0;
#X connect 92 4 46 0;
#X connect 92 5 94 0;
#X connect 94 0 93 0;
